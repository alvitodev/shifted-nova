---
import type { CollectionEntry } from 'astro:content'
import { getCombinedReadingTime } from '@/lib/data-utils'
import { formatDate } from '@/lib/utils'
import { Image } from 'astro:assets'
import Link from '@/components/Link.astro'
import { Badge } from '@/components/ui/badge'

interface Props {
  entry: CollectionEntry<'writing'>
}

const { entry } = Astro.props

const formattedDate = formatDate(entry.data.publishDate)
const readTime = await getCombinedReadingTime(entry.id)
---

<div class="border border-zinc-800 rounded-lg p-4 bg-zinc-900/50 hover:bg-zinc-900 transition-colors group">
  <Link
    href={`/writing/${entry.id}`}
    class="flex flex-col gap-4"
  >
    <div class="flex flex-col gap-2">
      {entry.data.heroImage && (
        <div class="relative w-full aspect-video overflow-hidden rounded-md border border-zinc-800">
            <Image
              src={entry.data.heroImage}
              alt={entry.data.title}
              width={600}
              height={338}
              class="object-cover w-full h-full transition-transform group-hover:scale-105"
            />
        </div>
      )}
      
      <div>
        <h3 class="text-lg font-bold text-zinc-200 group-hover:text-yellow-500 transition-colors">
          {entry.data.title}
        </h3>
        <div class="flex items-center gap-2 text-xs text-zinc-500 mt-1 font-mono">
          <span>{formattedDate}</span>
          <span>â€¢</span>
          <span>{readTime}</span>
        </div>
      </div>

      <p class="text-sm text-zinc-400 line-clamp-2">
        {entry.data.description}
      </p>

      {/* Tags */}
      <div class="flex gap-2 mt-2 flex-wrap">
        {(entry.data.tags ?? []).map((tag) => (
          <Badge variant="outline" className="text-xs px-1.5 py-0 text-zinc-500 border-zinc-700">
            #{tag}
          </Badge>
        ))}
      </div>
    </div>
  </Link>
</div>
